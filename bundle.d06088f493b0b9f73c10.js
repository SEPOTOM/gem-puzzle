(self.webpackChunktest=self.webpackChunktest||[]).push([[179],{394:function(t,e,o){"use strict";function n(t,e){return Math.floor((Math.random()+t)*(e-t))}function a(t){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild}function i(t){var e=a('<div class="tile"> <div class="tile__body"></div> </div> '),o=e.firstElementChild;return t?o.textContent=t:e.classList.add("tile_empty"),e}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=!(!t||t.length%e!=0),a=document.querySelector(".game-block__field");a.innerHTML="";for(var s=o?null:[],r={x:-1,y:0},c=l(),u=0;u<Math.pow(e,2);u++){var d=o?t[u]:n(0,Math.pow(e,2));if(!o){for(;s.includes(d);)d=n(0,Math.pow(e,2));s.push(d)}r.x===e-1?(r.x=0,r.y++):r.x++;var m=i(d);m.dataset.x=r.x,m.dataset.y=r.y,c.append(m),u>0&&(u+1)%e==0&&(a.append(c),c=l())}}function l(){var t=document.createElement("div");return t.classList.add("game-block__row"),t}var r={emptyTile:null,x:null,y:null,set:function(t){t?(this.emptyTile.firstElementChild.textContent=t.textContent,this.emptyTile.classList.remove("tile_empty"),this.emptyTile=t,this.emptyTile.classList.add("tile_empty")):this.emptyTile=document.querySelector(".tile_empty"),this.x=this.emptyTile.dataset.x,this.y=this.emptyTile.dataset.y,this.emptyTile.firstElementChild.innerHTML=""},get:function(){return{element:this.emptyTile,x:this.x,y:this.y}}},c=document.querySelector("[data-moves]"),u=function(){c.textContent=+c.textContent+1},d=o.p+"audio/tile-sound.mp3",m=new Audio;m.src=d;var v={muted:!1,play:function(){v.muted||(m.paused||(m.currentTime=0),m.play())},toggleMuted:function(){v.muted=!v.muted}},f=v;function p(t,e,o){var n=e.offsetWidth,a=e.offsetHeight,i=function(t,e){return t.x<e.x?"right":t.x>e.x?"left":t.y<e.y?"bottom":t.y>e.y?"top":void 0}({x:e.dataset.x,y:e.dataset.y},o),s={direction:i};return t?("right"===i?(s.leftBound=t.x,s.rightBound=t.x+n):"left"===i?(s.leftBound=t.x-n,s.rightBound=t.x):"top"===i?(s.topBound=t.y-a,s.bottomBound=t.y):"bottom"===i&&(s.topBound=t.y,s.bottomBound=t.y+a),s):s}var h={data:null,set:function(){var t=localStorage.getItem("progress"),e=JSON.parse(t);this.data=e},get:function(){return this.data},delete:function(){localStorage.removeItem("progress"),this.data=null}};h.set();var g=h;function y(){var t=document.querySelector(".game-block__field");return g.get()?g.get().size:t.className.includes("tiles")?t.className[t.className.length-1]:4}function b(t){return(+t.x==r.x-1||t.x-1==+r.x)&&t.y===r.y||(+t.y==r.y-1||t.y-1==+r.y)&&t.x===r.x}function _(){var t=document.querySelectorAll(".tile"),e=t[0],o=t[t.length-1],n=!1;if("1"===e.textContent.trim()&&o.classList.contains("tile_empty"))for(var a=0;a<t.length-1;a++){if(+t[a].textContent!==a+1){n=!1;break}n=!0}return n}var x=0,S=0,k=document.querySelector("[data-time]"),L=null;function T(){60==++x&&(x=0,S++);var t=x.toString();t.length<2&&(t="0"+t);var e=S.toString();e.length<2&&(e="0"+e),k.textContent="".concat(e,":").concat(t)}var C={paused:!0,setValue:function(t){k||(k=document.querySelector("[data-time]")),k.textContent=t},start:function(){k||(k=document.querySelector("[data-time]")),k.textContent="00:00",x=0,S=0,L=setInterval(T,1e3),this.paused=!1},continue:function(){var t;this.stop(),t=k.textContent.split(":"),S=+t[0],x=+t[1],k||(k=document.querySelector("[data-time]")),L=setInterval(T,1e3),this.paused=!1},stop:function(){k||(k=document.querySelector("[data-time]")),clearInterval(L),this.paused=!0}},q=document.querySelector("[data-time-button]"),w=function(t){q||(q=document.querySelector("[data-time-button]")),q.textContent=t?"Continue":"Stop"},E={show:function(t){var e=document.querySelector(t).closest(".popup");document.documentElement.classList.add("no-scroll"),e.classList.add("popup_showed"),e.classList.add("popup_active"),e.addEventListener("click",this.hide)},hide:function(t){var e=t.target,o=e.closest(".popup");o&&(e.closest(".popup__button")||e.closest(".popup__background"))&&(o.classList.remove("popup_active"),setTimeout((function(){document.documentElement.classList.remove("no-scroll"),o.classList.remove("popup_showed")}),300))}};function B(t,e){var o=document.createElement(t);return o.textContent=e,o.classList.add("title"),o}var z={show:function(){this.setText(),E.show(".congratulations")},setText:function(){var t=document.querySelector(".congratulations");t.innerHTML="";var e,o=document.querySelector("[data-moves]"),n=document.querySelector("[data-time]"),i=B("h2","Hooray! You solved the puzzle in ".concat(n.textContent," and ").concat(o.textContent," moves!")),s=('You can save your result by clicking on the "Save" button',(e=a('<p class="left-sided-paragraph"></p> ')).textContent='You can save your result by clicking on the "Save" button',e);t.append(i,s)}},M=z,N={completed:!1,finish:function(){C.stop(),X.disable(),w(!0),M.show(),this.completed=!0},setToDefault:function(){this.completed=!1}},A=!!("ontouchstart"in window),I=null;function H(t){if(t&&t.target){var e=t.target.closest(".tile");if(!e)return;if(!b({x:e.dataset.x,y:e.dataset.y}))return;W.disable();var o=r.get(),n={};"mousedown"===t.type?(n.x=t.pageX,n.y=t.pageY):"touchstart"===t.type&&(n.x=t.changedTouches[0].pageX,n.y=t.changedTouches[0].pageY);var a=(J.offsetWidth-2-2*y())/y()+2,i=p(n,e,o);i.currentTile=e.firstElementChild,i.currentTileSize=a,I=Y.bind(null,i),A?document.addEventListener("touchmove",I):document.addEventListener("mousemove",I),e.onmouseup=D,e.ontouchend=D}}function Y(t,e){var o=t.currentTile,n=o.closest(".tile"),a=t.currentTileSize,i=0;o.classList.add("tile__body_active");var s={};"mousemove"===e.type?(s.x=e.pageX,s.y=e.pageY):"touchmove"===e.type&&(s.x=e.changedTouches[0].pageX,s.y=e.changedTouches[0].pageY),"left"===t.direction?(i=o.offsetWidth-(s.x-t.leftBound),s.x<t.leftBound&&(i=a),s.x>=t.rightBound&&(i=0),o.style.left="-".concat(i,"px")):"right"===t.direction?(i=s.x-t.leftBound,s.x<t.leftBound&&(i=0),s.x>=t.rightBound&&(i=a),o.style.left="".concat(i,"px")):"top"===t.direction?(i=o.offsetHeight-(s.y-t.topBound),s.y<t.topBound&&(i=a),s.y>=t.bottomBound&&(i=0),o.style.top="-".concat(i,"px")):"bottom"===t.direction&&(i=s.y-t.topBound,s.y<t.topBound&&(i=0),s.y>=t.bottomBound&&(i=a),o.style.top="".concat(i,"px")),t.shift=i,n.onmouseup=null,n.ontouchend=null,A?document.ontouchend=O.bind(null,t):document.onmouseup=O.bind(null,t)}function O(t){document.removeEventListener("mousemove",I),document.removeEventListener("touchmove",I);var e=t.currentTile,o=e.closest(".tile"),n=t.currentTileSize,a=100*t.shift/n>15;e.classList.add("tile__body_transition"),"left"===t.direction?e.style.left="-".concat(a?n:0,"px"):"right"===t.direction?e.style.left="".concat(a?n:0,"px"):"top"===t.direction?e.style.top="-".concat(a?n:0,"px"):"bottom"===t.direction&&(e.style.top="".concat(a?n:0,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",W.enable(),I=null,document.onmouseup=null,document.ontouchend=null,f.play(),a&&(r.set(o),u()),_()&&N.finish()}),100)}function D(t){if(document.removeEventListener("mousemove",I),document.removeEventListener("touchmove",I),I=null,W.enabled&&W.disable(),t&&t.target){var e=t.target.closest(".tile__body"),o=e.closest(".tile");if(o.onmouseup=null,o.ontouchend=null,!e)return void W.enable();var n={x:o.dataset.x,y:o.dataset.y};if(o.classList.contains("tile_empty"))return void W.enable();if(!b(n))return void W.enable();var a=(J.offsetWidth-2-2*y())/y()+2,i=r.get(),s=p(null,o,i);e.classList.add("tile__body_active"),e.classList.add("tile__body_transition"),"left"===s.direction?e.style.left="-".concat(a,"px"):"right"===s.direction?e.style.left="".concat(a,"px"):"top"===s.direction?e.style.top="-".concat(a,"px"):"bottom"===s.direction&&(e.style.top="".concat(a,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",W.enable(),I=null,r.set(o),u(),f.play(),_()&&N.finish()}),100)}}var J=document.querySelector(".game-block__field"),W={enabled:!1,enable:function(){J||(J=document.querySelector(".game-block__field")),J.ondragstart=null,A?J.addEventListener("touchstart",H):J.addEventListener("mousedown",H),this.enabled=!0},disable:function(){J||(J=document.querySelector(".game-block__field")),A?J.removeEventListener("touchstart",H):J.removeEventListener("mousedown",H),this.enabled=!1}},X=W;function V(t,e){w(!1),c||(c=document.querySelector("[data-moves]")),c.textContent=0,s(null,t),C.setValue("00:00"),C.stop(),g.delete(),e&&C.start()}var F={handler:function(t){var e=t.currentTarget.dataset.size;V(e),F.set(e)},set:function(t){var e=document.querySelector(".game-block__field"),o=window.innerHeight,n=document.querySelector("[data-current-size]");switch(e.className=3==+t?"game-block__field game-block__field_small":4==+t||5==+t?"game-block__field":o-200>500?"game-block__field game-block__field_big":"game-block__field",+t){case 3:e.classList.add("tiles-3x3");break;case 5:e.classList.add("tiles-5x5");break;case 6:e.classList.add("tiles-6x6");break;case 7:e.classList.add("tiles-7x7");break;case 8:e.classList.add("tiles-8x8")}n.textContent="".concat(t,"x").concat(t),X.disable()}},R=F,j={started:!1,init:function(t){var e,o=y();C.stop(),t&&""===t.currentTarget.dataset.start&&(C.start(),j.started=!0),j.started&&g.delete(),g.get()?(e=g.get().moves,c||(c=document.querySelector("[data-moves]")),c.textContent=e,C.setValue(g.get().time),R.set(o),s(g.get().tilesNums,o),w(!0)):V(o,t),r.set(),N.setToDefault(),!X.enabled&&t&&""===t.currentTarget.dataset.start&&X.enable()},setStarted:function(t){j.started=t}},G=j;o(296);var K=a('<button class="volume-button" type="button"></button> ');K.addEventListener("click",(function(){f.toggleMuted(),this.classList.toggle("volume-button_muted")}));var P=K;function Q(t){var e=t.split(":");return 60*e[0]+ +e[1]}function U(t){this.value=t,this.left=null,this.right=null}var Z=function(t){if(!t.root)return null;for(var e=t.root;e.right;)e=e.right;return e},$=function(t){if(t.root)if(t.root.left||t.root.right||(t.root=null),!t.root.left||t.root.right){for(var e=null,o=t.root;o.right;)e=o,o=o.right;e.right=o.left,t.length--}else t.root=t.root.left},tt={save:function(){var t=tt.get()||{root:null,length:0},e=y(),o=document.querySelector("[data-moves]"),n=document.querySelector("[data-time]"),a={size:e,moves:o.textContent,time:n.textContent};if(Z(t)&&10===t.length){if(tt.has(t,a)||tt.moreThanBiggest(t,a))return;$(t)}!function(t,e){if(!t.root)return t.root=new U(e),void t.length++;for(var o=Q(e.time),n=+e.moves,a=t.root,i=a.value,s=Q(i.time),l=+i.moves;;){if(s=Q((i=a.value).time),l=+i.moves,o===s&&n===l){t.length--;break}if((o<s||o===s&&n<l)&&a.left)a=a.left;else{if((o<s||o===s&&n<l)&&!a.left){a.left=new U(e);break}if((o>s||o===s&&n>l)&&a.right)a=a.right;else if((o>s||o===s&&n>l)&&!a.right){a.right=new U(e);break}}}t.length<10&&t.length++}(t,a);var i=JSON.stringify(t);localStorage.setItem("leaderboard-".concat(e,"x").concat(e),i)},get:function(){var t=y(),e=localStorage.getItem("leaderboard-".concat(t,"x").concat(t));return e?JSON.parse(e):null},has:function(t,e){if(!t.root)return!1;for(var o=!1,n=t.root,a=Q(e.time),i=Q(n.value.time);;){if(a===(i=Q(n.value.time))&&e.moves===n.value.moves){o=!0;break}if((a<i||a===i&&e.moves<n.value.moves)&&n.left)n=n.left;else{if(!(a>i||a===i&&e.moves>n.value.moves)||!n.right)break;n=n.right}}return o},moreThanBiggest:function(t,e){if(!t.root)return!1;var o=Z(t),n=Q(o.value.time),a=Q(e.time);return n<a||n===a&&o.value.moves<e.moves}},et=tt;function ot(t,e){t.left&&ot(t.left,e),e(t),t.right&&ot(t.right,e)}function nt(t,e){if(!t.root)return null;ot(t.root,e)}var at=document.querySelector(".leaderboard"),it=1,st={show:function(){at||(at=document.querySelector(".leaderboard"));var t=et.get();t?st.fill(t):st.fill(),E.show(".leaderboard")},fill:function(t){if(at||(at=document.querySelector(".leaderboard")),at.innerHTML="",t){var e=B("h2","Results");at.append(e),nt(t,st.createAndAppendItem),it=1}else{var o=B("h2","No results for this frame size yet");at.append(o)}},createAndAppendItem:function(t){var e=document.createElement("div");e.className="leaderboard__item",e.textContent=it+".";var o=document.createElement("div");o.className="leaderboard__item leaderboard__item_big",o.textContent="".concat(t.value.moves," / ").concat(t.value.time);var n=document.createElement("div");n.className="leaderboard__item",n.textContent="Frame size: ".concat(t.value.size,"x").concat(t.value.size);var i,s,l,r,c=(i=e,s=o,l=n,(r=a('<div class="column-3-center-big"></div> ')).append(i,s,l),r);at.append(c),it++}},lt=st;function rt(t,e,o){var n=a('<button class="small-button" type="button"></button> ');return n.textContent=t,n.addEventListener("click",e),o&&n.setAttribute(o,""),n}function ct(t,e,o){var n=a('<button class="underlined-button" type="button"></button> ');if(n.addEventListener("click",e),n.textContent=t,o&&o.includes("=")){var i=o.split("=");n.setAttribute(i[0],i[1])}else o&&n.setAttribute(o,"");return n}var ut=a('<div class="game-block"> <div class="game-block__heading"> <div class="game-block__controls"></div> <div class="game-block__info"> <div class="game-block__data">Moves: <span data-moves>0</span></div> <div class="game-block__data">Time: <span data-time>00:00</span></div> </div> </div> <div class="game-block__field"></div> <div class="game-block__footer"> <div class="game-block__info"> <div class="game-block__data game-block__data_small">Frame size: <span data-current-size>4x4</span></div> </div> <div class="game-block__controls game-block__controls_small"> <span>Other sizes:</span> </div> </div> </div> '),dt=ut.querySelector(".game-block__heading .game-block__controls"),mt=rt("Shuffle and start",G.init,"data-start"),vt=rt("Stop",(function(){if(q||(q=document.querySelector("[data-time-button]")),g.get()&&!G.started)return G.setStarted(!0),q.textContent="Stop",C.continue(),X.enabled||X.enable(),void g.delete();C.paused&&G.started?(q.textContent="Stop",C.continue(),X.enabled||X.enable()):G.started&&(q.textContent="Continue",C.stop(),X.enabled&&X.disable())}),"data-time-button"),ft=rt("Save",(function(){if(N.completed&&et.save(),G.started){var t=document.querySelectorAll(".tile"),e=[];t.forEach((function(t){t.classList.contains("tile_empty")?e.push(0):e.push(+t.textContent)}));var o=document.querySelector("[data-moves]"),n=document.querySelector("[data-time]"),a=Math.sqrt(t.length),i={tilesNums:e,size:a,moves:o.textContent,time:n.textContent},s=JSON.stringify(i);localStorage.setItem("progress",s)}})),pt=rt("Results",lt.show);dt.append(mt,vt,ft,pt);for(var ht=ut.querySelector(".game-block__footer .game-block__controls"),gt=3;gt<9;gt++){var yt=ct("".concat(gt,"x").concat(gt),R.handler,"data-size=".concat(gt));ht.append(yt)}var bt=ut;function _t(t){var e=a('<div class="popup"> <div class="popup__body"> <button class="popup__button" type="button"></button> </div> <div class="popup__background"></div> </div> ');return e.querySelector(".popup__body").prepend(t),e}var xt=a('<div class="leaderboard"></div> '),St=a('<div class="congratulations"></div> '),kt=_t(xt),Lt=_t(St),Tt=a('<div class="wrapper"></div> ');Tt.append(bt,P,kt,Lt);var Ct=Tt;document.body.append(Ct),G.init()},296:function(){var t=0;document.addEventListener("touchend",(function(e){var o=(new Date).getTime();o-t<=300&&e.preventDefault(),t=o}),!1)}},function(t){t(t.s=394)}]);