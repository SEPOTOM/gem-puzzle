(self.webpackChunktest=self.webpackChunktest||[]).push([[179],{394:function(t,e,n){"use strict";function o(t,e){return Math.floor((Math.random()+t)*(e-t))}function a(t){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild}function i(t){var e=a('<div class="tile"> <div class="tile__body"></div> </div> '),n=e.firstElementChild;return t?n.textContent=t:e.classList.add("tile_empty"),e}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=!(!t||t.length%e!=0),a=document.querySelector(".game-block__field");a.innerHTML="";for(var r=n?null:[],l={x:-1,y:0},c=s(),u=0;u<Math.pow(e,2);u++){var d=n?t[u]:o(0,Math.pow(e,2));if(!n){for(;r.includes(d);)d=o(0,Math.pow(e,2));r.push(d)}l.x===e-1?(l.x=0,l.y++):l.x++;var m=i(d);m.dataset.x=l.x,m.dataset.y=l.y,c.append(m),u>0&&(u+1)%e==0&&(a.append(c),c=s())}}function s(){var t=document.createElement("div");return t.classList.add("game-block__row"),t}var l={emptyTile:null,x:null,y:null,set:function(t){t?(this.emptyTile.firstElementChild.textContent=t.textContent,this.emptyTile.classList.remove("tile_empty"),this.emptyTile=t,this.emptyTile.classList.add("tile_empty")):this.emptyTile=document.querySelector(".tile_empty"),this.x=this.emptyTile.dataset.x,this.y=this.emptyTile.dataset.y,this.emptyTile.firstElementChild.innerHTML=""},get:function(){return{element:this.emptyTile,x:this.x,y:this.y}}},c=document.querySelector("[data-moves]"),u=function(){c.textContent=+c.textContent+1},d=n.p+"audio/tile-sound.mp3",m=new Audio,v=new(window.AudioContext||window.webkitAudioContext);document.addEventListener("click",(function(){m.src=d,"suspended"===v.state&&v.resume(),v.createMediaElementSource(m).connect(v.destination)}),{once:!0});var f={playing:!1,play:function(){f.playing||(m.paused||(m.pause(),m.currentTime=0),m.play())},togglePlaying:function(){f.playing=!f.playing}},p=f;function g(t,e,n){var o=e.offsetWidth,a=e.offsetHeight,i=function(t,e){return t.x<e.x?"right":t.x>e.x?"left":t.y<e.y?"bottom":t.y>e.y?"top":void 0}({x:e.dataset.x,y:e.dataset.y},n),r={direction:i};return t?("right"===i?(r.leftBound=t.x,r.rightBound=t.x+o):"left"===i?(r.leftBound=t.x-o,r.rightBound=t.x):"top"===i?(r.topBound=t.y-a,r.bottomBound=t.y):"bottom"===i&&(r.topBound=t.y,r.bottomBound=t.y+a),r):r}var h={data:null,set:function(){var t=localStorage.getItem("progress"),e=JSON.parse(t);this.data=e},get:function(){return this.data},delete:function(){localStorage.removeItem("progress"),this.data=null}};h.set();var y=h;function b(){var t=document.querySelector(".game-block__field");return y.get()?y.get().size:t.className.includes("tiles")?t.className[t.className.length-1]:4}function _(t){return(+t.x==l.x-1||t.x-1==+l.x)&&t.y===l.y||(+t.y==l.y-1||t.y-1==+l.y)&&t.x===l.x}function x(){var t=document.querySelectorAll(".tile"),e=t[0],n=t[t.length-1],o=!1;if("1"===e.textContent.trim()&&n.classList.contains("tile_empty"))for(var a=0;a<t.length-1;a++){if(+t[a].textContent!==a+1){o=!1;break}o=!0}return o}var S=0,k=0,L=document.querySelector("[data-time]"),C=null;function T(){60==++S&&(S=0,k++);var t=S.toString();t.length<2&&(t="0"+t);var e=k.toString();e.length<2&&(e="0"+e),L.textContent="".concat(e,":").concat(t)}var w={paused:!0,setValue:function(t){L||(L=document.querySelector("[data-time]")),L.textContent=t},start:function(){L||(L=document.querySelector("[data-time]")),L.textContent="00:00",S=0,k=0,C=setInterval(T,1e3),this.paused=!1},continue:function(){var t;this.stop(),t=L.textContent.split(":"),k=+t[0],S=+t[1],L||(L=document.querySelector("[data-time]")),C=setInterval(T,1e3),this.paused=!1},stop:function(){L||(L=document.querySelector("[data-time]")),clearInterval(C),this.paused=!0}},q=document.querySelector("[data-time-button]"),E=function(t){q||(q=document.querySelector("[data-time-button]")),q.textContent=t?"Continue":"Stop"},B={show:function(t){var e=document.querySelector(t).closest(".popup");document.documentElement.classList.add("no-scroll"),e.classList.add("popup_showed"),e.classList.add("popup_active"),e.addEventListener("click",this.hide)},hide:function(t){var e=t.target,n=e.closest(".popup");n&&(e.closest(".popup__button")||e.closest(".popup__background"))&&(n.classList.remove("popup_active"),setTimeout((function(){document.documentElement.classList.remove("no-scroll"),n.classList.remove("popup_showed")}),300))}};function A(t,e){var n=document.createElement(t);return n.textContent=e,n.classList.add("title"),n}var z={show:function(){this.setText(),B.show(".congratulations")},setText:function(){var t=document.querySelector(".congratulations");t.innerHTML="";var e,n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),i=A("h2","Hooray! You solved the puzzle in ".concat(o.textContent," and ").concat(n.textContent," moves!")),r=('You can save your result by clicking on the "Save" button',(e=a('<p class="left-sided-paragraph"></p> ')).textContent='You can save your result by clicking on the "Save" button',e);t.append(i,r)}},M=z,N={completed:!1,finish:function(){w.stop(),X.disable(),E(!0),M.show(),this.completed=!0},setToDefault:function(){this.completed=!1}},I=!!("ontouchstart"in window),H=null;function O(t){if(t&&t.target){var e=t.target.closest(".tile");if(!e)return;if(!_({x:e.dataset.x,y:e.dataset.y}))return;J.disable();var n=l.get(),o={};"mousedown"===t.type?(o.x=t.pageX,o.y=t.pageY):"touchstart"===t.type&&(o.x=t.changedTouches[0].pageX,o.y=t.changedTouches[0].pageY);var a=(D.offsetWidth-2-2*b())/b()+2,i=g(o,e,n);i.currentTile=e.firstElementChild,i.currentTileSize=a,H=Y.bind(null,i),I?document.addEventListener("touchmove",H):document.addEventListener("mousemove",H),e.onmouseup=W,e.ontouchend=W}}function Y(t,e){var n=t.currentTile,o=n.closest(".tile"),a=t.currentTileSize,i=0;n.classList.add("tile__body_active");var r={};"mousemove"===e.type?(r.x=e.pageX,r.y=e.pageY):"touchmove"===e.type&&(r.x=e.changedTouches[0].pageX,r.y=e.changedTouches[0].pageY),"left"===t.direction?(i=n.offsetWidth-(r.x-t.leftBound),r.x<t.leftBound&&(i=a),r.x>=t.rightBound&&(i=0),n.style.left="-".concat(i,"px")):"right"===t.direction?(i=r.x-t.leftBound,r.x<t.leftBound&&(i=0),r.x>=t.rightBound&&(i=a),n.style.left="".concat(i,"px")):"top"===t.direction?(i=n.offsetHeight-(r.y-t.topBound),r.y<t.topBound&&(i=a),r.y>=t.bottomBound&&(i=0),n.style.top="-".concat(i,"px")):"bottom"===t.direction&&(i=r.y-t.topBound,r.y<t.topBound&&(i=0),r.y>=t.bottomBound&&(i=a),n.style.top="".concat(i,"px")),t.shift=i,o.onmouseup=null,o.ontouchend=null,I?document.ontouchend=P.bind(null,t):document.onmouseup=P.bind(null,t)}function P(t){document.removeEventListener("mousemove",H),document.removeEventListener("touchmove",H);var e=t.currentTile,n=e.closest(".tile"),o=t.currentTileSize,a=100*t.shift/o>15;e.classList.add("tile__body_transition"),"left"===t.direction?e.style.left="-".concat(a?o:0,"px"):"right"===t.direction?e.style.left="".concat(a?o:0,"px"):"top"===t.direction?e.style.top="-".concat(a?o:0,"px"):"bottom"===t.direction&&(e.style.top="".concat(a?o:0,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",J.enable(),H=null,document.onmouseup=null,document.ontouchend=null,p.play(),a&&(l.set(n),u()),x()&&N.finish()}),100)}function W(t){if(document.removeEventListener("mousemove",H),document.removeEventListener("touchmove",H),H=null,J.enabled&&J.disable(),t&&t.target){var e=t.target.closest(".tile__body"),n=e.closest(".tile");if(n.onmouseup=null,n.ontouchend=null,!e)return void J.enable();var o={x:n.dataset.x,y:n.dataset.y};if(n.classList.contains("tile_empty"))return void J.enable();if(!_(o))return void J.enable();var a=(D.offsetWidth-2-2*b())/b()+2,i=l.get(),r=g(null,n,i);e.classList.add("tile__body_active"),e.classList.add("tile__body_transition"),"left"===r.direction?e.style.left="-".concat(a,"px"):"right"===r.direction?e.style.left="".concat(a,"px"):"top"===r.direction?e.style.top="-".concat(a,"px"):"bottom"===r.direction&&(e.style.top="".concat(a,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",J.enable(),H=null,l.set(n),u(),p.play(),x()&&N.finish()}),100)}}var D=document.querySelector(".game-block__field"),J={enabled:!1,enable:function(){D||(D=document.querySelector(".game-block__field")),D.ondragstart=null,I?D.addEventListener("touchstart",O):D.addEventListener("mousedown",O),this.enabled=!0},disable:function(){D||(D=document.querySelector(".game-block__field")),I?D.removeEventListener("touchstart",O):D.removeEventListener("mousedown",O),this.enabled=!1}},X=J;function V(t,e){E(!1),c||(c=document.querySelector("[data-moves]")),c.textContent=0,r(null,t),w.setValue("00:00"),w.stop(),y.delete(),e&&w.start()}var F={handler:function(t){var e=t.currentTarget.dataset.size;V(e),F.set(e)},set:function(t){var e=document.querySelector(".game-block__field"),n=window.innerHeight,o=document.querySelector("[data-current-size]");switch(e.className=3==+t?"game-block__field game-block__field_small":4==+t||5==+t?"game-block__field":n-200>500?"game-block__field game-block__field_big":"game-block__field",+t){case 3:e.classList.add("tiles-3x3");break;case 5:e.classList.add("tiles-5x5");break;case 6:e.classList.add("tiles-6x6");break;case 7:e.classList.add("tiles-7x7");break;case 8:e.classList.add("tiles-8x8")}o.textContent="".concat(t,"x").concat(t),X.disable()}},R=F,j={started:!1,init:function(t){var e,n=b();w.stop(),t&&""===t.currentTarget.dataset.start&&(w.start(),j.started=!0),j.started&&y.delete(),y.get()?(e=y.get().moves,c||(c=document.querySelector("[data-moves]")),c.textContent=e,w.setValue(y.get().time),R.set(n),r(y.get().tilesNums,n),E(!0)):V(n,t),l.set(),N.setToDefault(),!X.enabled&&t&&""===t.currentTarget.dataset.start&&X.enable()},setStarted:function(t){j.started=t}},G=j;n(296),n(752);var K=a('<button class="volume-button" type="button"></button> ');K.addEventListener("click",(function(){p.togglePlaying(),this.classList.toggle("volume-button_muted")}));var Q=K;function U(t){var e=t.split(":");return 60*e[0]+ +e[1]}function Z(t){this.value=t,this.left=null,this.right=null}var $=function(t){if(!t.root)return null;for(var e=t.root;e.right;)e=e.right;return e},tt=function(t){if(t.root)if(t.root.left||t.root.right||(t.root=null),!t.root.left||t.root.right){for(var e=null,n=t.root;n.right;)e=n,n=n.right;e.right=n.left,t.length--}else t.root=t.root.left},et={save:function(){var t=et.get()||{root:null,length:0},e=b(),n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),a={size:e,moves:n.textContent,time:o.textContent};if($(t)&&10===t.length){if(et.has(t,a)||et.moreThanBiggest(t,a))return;tt(t)}!function(t,e){if(!t.root)return t.root=new Z(e),void t.length++;for(var n=U(e.time),o=+e.moves,a=t.root,i=a.value,r=U(i.time),s=+i.moves;;){if(r=U((i=a.value).time),s=+i.moves,n===r&&o===s){t.length--;break}if((n<r||n===r&&o<s)&&a.left)a=a.left;else{if((n<r||n===r&&o<s)&&!a.left){a.left=new Z(e);break}if((n>r||n===r&&o>s)&&a.right)a=a.right;else if((n>r||n===r&&o>s)&&!a.right){a.right=new Z(e);break}}}t.length<10&&t.length++}(t,a);var i=JSON.stringify(t);localStorage.setItem("leaderboard-".concat(e,"x").concat(e),i)},get:function(){var t=b(),e=localStorage.getItem("leaderboard-".concat(t,"x").concat(t));return e?JSON.parse(e):null},has:function(t,e){if(!t.root)return!1;for(var n=!1,o=t.root,a=U(e.time),i=U(o.value.time);;){if(a===(i=U(o.value.time))&&e.moves===o.value.moves){n=!0;break}if((a<i||a===i&&e.moves<o.value.moves)&&o.left)o=o.left;else{if(!(a>i||a===i&&e.moves>o.value.moves)||!o.right)break;o=o.right}}return n},moreThanBiggest:function(t,e){if(!t.root)return!1;var n=$(t),o=U(n.value.time),a=U(e.time);return o<a||o===a&&n.value.moves<e.moves}},nt=et;function ot(t,e){t.left&&ot(t.left,e),e(t),t.right&&ot(t.right,e)}function at(t,e){if(!t.root)return null;ot(t.root,e)}var it=document.querySelector(".leaderboard"),rt=1,st={show:function(){it||(it=document.querySelector(".leaderboard"));var t=nt.get();t?st.fill(t):st.fill(),B.show(".leaderboard")},fill:function(t){if(it||(it=document.querySelector(".leaderboard")),it.innerHTML="",t){var e=A("h2","Results");it.append(e),at(t,st.createAndAppendItem),rt=1}else{var n=A("h2","No results for this frame size yet");it.append(n)}},createAndAppendItem:function(t){var e=document.createElement("div");e.className="leaderboard__item",e.textContent=rt+".";var n=document.createElement("div");n.className="leaderboard__item leaderboard__item_big",n.textContent="".concat(t.value.moves," / ").concat(t.value.time);var o=document.createElement("div");o.className="leaderboard__item",o.textContent="Frame size: ".concat(t.value.size,"x").concat(t.value.size);var i,r,s,l,c=(i=e,r=n,s=o,(l=a('<div class="column-3-center-big"></div> ')).append(i,r,s),l);it.append(c),rt++}},lt=st;function ct(t,e,n){var o=a('<button class="small-button" type="button"></button> ');return o.textContent=t,o.addEventListener("click",e),n&&o.setAttribute(n,""),o}function ut(t,e,n){var o=a('<button class="underlined-button" type="button"></button> ');if(o.addEventListener("click",e),o.textContent=t,n&&n.includes("=")){var i=n.split("=");o.setAttribute(i[0],i[1])}else n&&o.setAttribute(n,"");return o}var dt=a('<div class="game-block"> <div class="game-block__heading"> <div class="game-block__controls"></div> <div class="game-block__info"> <div class="game-block__data">Moves: <span data-moves>0</span></div> <div class="game-block__data">Time: <span data-time>00:00</span></div> </div> </div> <div class="game-block__field"></div> <div class="game-block__footer"> <div class="game-block__info"> <div class="game-block__data game-block__data_small">Frame size: <span data-current-size>4x4</span></div> </div> <div class="game-block__controls game-block__controls_small"> <span>Other sizes:</span> </div> </div> </div> '),mt=dt.querySelector(".game-block__heading .game-block__controls"),vt=ct("Shuffle and start",G.init,"data-start"),ft=ct("Stop",(function(){if(q||(q=document.querySelector("[data-time-button]")),y.get()&&!G.started)return G.setStarted(!0),q.textContent="Stop",w.continue(),X.enabled||X.enable(),void y.delete();w.paused&&G.started?(q.textContent="Stop",w.continue(),X.enabled||X.enable()):G.started&&(q.textContent="Continue",w.stop(),X.enabled&&X.disable())}),"data-time-button"),pt=ct("Save",(function(){if(N.completed&&nt.save(),G.started){var t=document.querySelectorAll(".tile"),e=[];t.forEach((function(t){t.classList.contains("tile_empty")?e.push(0):e.push(+t.textContent)}));var n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),a=Math.sqrt(t.length),i={tilesNums:e,size:a,moves:n.textContent,time:o.textContent},r=JSON.stringify(i);localStorage.setItem("progress",r)}})),gt=ct("Results",lt.show);mt.append(vt,ft,pt,gt);for(var ht=dt.querySelector(".game-block__footer .game-block__controls"),yt=3;yt<9;yt++){var bt=ut("".concat(yt,"x").concat(yt),R.handler,"data-size=".concat(yt));ht.append(bt)}var _t=dt;function xt(t){var e=a('<div class="popup"> <div class="popup__body"> <button class="popup__button" type="button"></button> </div> <div class="popup__background"></div> </div> ');return e.querySelector(".popup__body").prepend(t),e}var St=a('<div class="leaderboard"></div> '),kt=a('<div class="congratulations"></div> '),Lt=xt(St),Ct=xt(kt),Tt=a('<div class="wrapper" data-fullscreen></div> ');Tt.append(_t,Q,Lt,Ct);var wt=Tt;document.body.append(wt),G.init()},296:function(){var t=0;document.addEventListener("touchend",(function(e){var n=(new Date).getTime();n-t<=300&&e.preventDefault(),t=n}),!1)},752:function(){var t={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return t.Android()||t.BlackBerry()||t.iOS()||t.Opera()||t.Windows()}};function e(){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px"))}document.querySelector("[data-fullscreen]")&&t.any()&&window.addEventListener("resize",e),e()}},function(t){t(t.s=394)}]);