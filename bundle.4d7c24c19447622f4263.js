(self.webpackChunktest=self.webpackChunktest||[]).push([[179],{394:function(t,e,n){"use strict";function o(t,e){return Math.floor((Math.random()+t)*(e-t))}function a(t){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild}function i(t){var e=a('<div class="tile"> <div class="tile__body"></div> </div> '),n=e.firstElementChild;return t?n.textContent=t:e.classList.add("tile_empty"),e}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=!(!t||t.length%e!=0),a=document.querySelector(".game-block__field");a.innerHTML="";for(var l=n?null:[],r={x:-1,y:0},c=s(),u=0;u<Math.pow(e,2);u++){var d=n?t[u]:o(0,Math.pow(e,2));if(!n){for(;l.includes(d);)d=o(0,Math.pow(e,2));l.push(d)}r.x===e-1?(r.x=0,r.y++):r.x++;var m=i(d);m.dataset.x=r.x,m.dataset.y=r.y,c.append(m),u>0&&(u+1)%e==0&&(a.append(c),c=s())}}function s(){var t=document.createElement("div");return t.classList.add("game-block__row"),t}var r={emptyTile:null,x:null,y:null,set:function(t){t?(this.emptyTile.firstElementChild.textContent=t.textContent,this.emptyTile.classList.remove("tile_empty"),this.emptyTile=t,this.emptyTile.classList.add("tile_empty")):this.emptyTile=document.querySelector(".tile_empty"),this.x=this.emptyTile.dataset.x,this.y=this.emptyTile.dataset.y,this.emptyTile.firstElementChild.innerHTML=""},get:function(){return{element:this.emptyTile,x:this.x,y:this.y}}},c=document.querySelector("[data-moves]"),u=function(){c.textContent=+c.textContent+1},d=n.p+"audio/tile-sound.mp3",m=new Audio;document.addEventListener("click",(function(){m.src=d}),{once:!0});var v={playing:!1,play:function(){v.playing||(m.paused||(m.currentTime=0),m.play())},togglePlaying:function(){v.playing=!v.playing}},p=v;function f(t,e,n){var o=e.offsetWidth,a=e.offsetHeight,i=function(t,e){return t.x<e.x?"right":t.x>e.x?"left":t.y<e.y?"bottom":t.y>e.y?"top":void 0}({x:e.dataset.x,y:e.dataset.y},n),l={direction:i};return t?("right"===i?(l.leftBound=t.x,l.rightBound=t.x+o):"left"===i?(l.leftBound=t.x-o,l.rightBound=t.x):"top"===i?(l.topBound=t.y-a,l.bottomBound=t.y):"bottom"===i&&(l.topBound=t.y,l.bottomBound=t.y+a),l):l}var g={data:null,set:function(){var t=localStorage.getItem("progress"),e=JSON.parse(t);this.data=e},get:function(){return this.data},delete:function(){localStorage.removeItem("progress"),this.data=null}};g.set();var h=g;function y(){var t=document.querySelector(".game-block__field");return h.get()?h.get().size:t.className.includes("tiles")?t.className[t.className.length-1]:4}function b(t){return(+t.x==r.x-1||t.x-1==+r.x)&&t.y===r.y||(+t.y==r.y-1||t.y-1==+r.y)&&t.x===r.x}function _(){var t=document.querySelectorAll(".tile"),e=t[0],n=t[t.length-1],o=!1;if("1"===e.textContent.trim()&&n.classList.contains("tile_empty"))for(var a=0;a<t.length-1;a++){if(+t[a].textContent!==a+1){o=!1;break}o=!0}return o}var x=0,S=0,k=document.querySelector("[data-time]"),L=null;function T(){60==++x&&(x=0,S++);var t=x.toString();t.length<2&&(t="0"+t);var e=S.toString();e.length<2&&(e="0"+e),k.textContent="".concat(e,":").concat(t)}var C={paused:!0,setValue:function(t){k||(k=document.querySelector("[data-time]")),k.textContent=t},start:function(){k||(k=document.querySelector("[data-time]")),k.textContent="00:00",x=0,S=0,L=setInterval(T,1e3),this.paused=!1},continue:function(){var t;this.stop(),t=k.textContent.split(":"),S=+t[0],x=+t[1],k||(k=document.querySelector("[data-time]")),L=setInterval(T,1e3),this.paused=!1},stop:function(){k||(k=document.querySelector("[data-time]")),clearInterval(L),this.paused=!0}},q=document.querySelector("[data-time-button]"),w=function(t){q||(q=document.querySelector("[data-time-button]")),q.textContent=t?"Continue":"Stop"},E={show:function(t){var e=document.querySelector(t).closest(".popup");document.documentElement.classList.add("no-scroll"),e.classList.add("popup_showed"),e.classList.add("popup_active"),e.addEventListener("click",this.hide)},hide:function(t){var e=t.target,n=e.closest(".popup");n&&(e.closest(".popup__button")||e.closest(".popup__background"))&&(n.classList.remove("popup_active"),setTimeout((function(){document.documentElement.classList.remove("no-scroll"),n.classList.remove("popup_showed")}),300))}};function B(t,e){var n=document.createElement(t);return n.textContent=e,n.classList.add("title"),n}var z={show:function(){this.setText(),E.show(".congratulations")},setText:function(){var t=document.querySelector(".congratulations");t.innerHTML="";var e,n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),i=B("h2","Hooray! You solved the puzzle in ".concat(o.textContent," and ").concat(n.textContent," moves!")),l=('You can save your result by clicking on the "Save" button',(e=a('<p class="left-sided-paragraph"></p> ')).textContent='You can save your result by clicking on the "Save" button',e);t.append(i,l)}},N=z,M={completed:!1,finish:function(){C.stop(),X.disable(),w(!0),N.show(),this.completed=!0},setToDefault:function(){this.completed=!1}},A=!!("ontouchstart"in window),I=null;function H(t){if(t&&t.target){var e=t.target.closest(".tile");if(!e)return;if(!b({x:e.dataset.x,y:e.dataset.y}))return;W.disable();var n=r.get(),o={};"mousedown"===t.type?(o.x=t.pageX,o.y=t.pageY):"touchstart"===t.type&&(o.x=t.changedTouches[0].pageX,o.y=t.changedTouches[0].pageY);var a=(J.offsetWidth-2-2*y())/y()+2,i=f(o,e,n);i.currentTile=e.firstElementChild,i.currentTileSize=a,I=Y.bind(null,i),A?document.addEventListener("touchmove",I):document.addEventListener("mousemove",I),e.onmouseup=D,e.ontouchend=D}}function Y(t,e){var n=t.currentTile,o=n.closest(".tile"),a=t.currentTileSize,i=0;n.classList.add("tile__body_active");var l={};"mousemove"===e.type?(l.x=e.pageX,l.y=e.pageY):"touchmove"===e.type&&(l.x=e.changedTouches[0].pageX,l.y=e.changedTouches[0].pageY),"left"===t.direction?(i=n.offsetWidth-(l.x-t.leftBound),l.x<t.leftBound&&(i=a),l.x>=t.rightBound&&(i=0),n.style.left="-".concat(i,"px")):"right"===t.direction?(i=l.x-t.leftBound,l.x<t.leftBound&&(i=0),l.x>=t.rightBound&&(i=a),n.style.left="".concat(i,"px")):"top"===t.direction?(i=n.offsetHeight-(l.y-t.topBound),l.y<t.topBound&&(i=a),l.y>=t.bottomBound&&(i=0),n.style.top="-".concat(i,"px")):"bottom"===t.direction&&(i=l.y-t.topBound,l.y<t.topBound&&(i=0),l.y>=t.bottomBound&&(i=a),n.style.top="".concat(i,"px")),t.shift=i,o.onmouseup=null,o.ontouchend=null,A?document.ontouchend=O.bind(null,t):document.onmouseup=O.bind(null,t)}function O(t){document.removeEventListener("mousemove",I),document.removeEventListener("touchmove",I);var e=t.currentTile,n=e.closest(".tile"),o=t.currentTileSize,a=100*t.shift/o>15;e.classList.add("tile__body_transition"),"left"===t.direction?e.style.left="-".concat(a?o:0,"px"):"right"===t.direction?e.style.left="".concat(a?o:0,"px"):"top"===t.direction?e.style.top="-".concat(a?o:0,"px"):"bottom"===t.direction&&(e.style.top="".concat(a?o:0,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",W.enable(),I=null,document.onmouseup=null,document.ontouchend=null,p.play(),a&&(r.set(n),u()),_()&&M.finish()}),100)}function D(t){if(document.removeEventListener("mousemove",I),document.removeEventListener("touchmove",I),I=null,W.enabled&&W.disable(),t&&t.target){var e=t.target.closest(".tile__body"),n=e.closest(".tile");if(n.onmouseup=null,n.ontouchend=null,!e)return void W.enable();var o={x:n.dataset.x,y:n.dataset.y};if(n.classList.contains("tile_empty"))return void W.enable();if(!b(o))return void W.enable();var a=(J.offsetWidth-2-2*y())/y()+2,i=r.get(),l=f(null,n,i);e.classList.add("tile__body_active"),e.classList.add("tile__body_transition"),"left"===l.direction?e.style.left="-".concat(a,"px"):"right"===l.direction?e.style.left="".concat(a,"px"):"top"===l.direction?e.style.top="-".concat(a,"px"):"bottom"===l.direction&&(e.style.top="".concat(a,"px")),setTimeout((function(){e.classList.remove("tile__body_transition"),e.classList.remove("tile__body_active"),e.style.cssText="",W.enable(),I=null,r.set(n),u(),p.play(),_()&&M.finish()}),100)}}var J=document.querySelector(".game-block__field"),W={enabled:!1,enable:function(){J||(J=document.querySelector(".game-block__field")),J.ondragstart=null,A?J.addEventListener("touchstart",H):J.addEventListener("mousedown",H),this.enabled=!0},disable:function(){J||(J=document.querySelector(".game-block__field")),A?J.removeEventListener("touchstart",H):J.removeEventListener("mousedown",H),this.enabled=!1}},X=W;function V(t,e){w(!1),c||(c=document.querySelector("[data-moves]")),c.textContent=0,l(null,t),C.setValue("00:00"),C.stop(),h.delete(),e&&C.start()}var F={handler:function(t){var e=t.currentTarget.dataset.size;V(e),F.set(e)},set:function(t){var e=document.querySelector(".game-block__field"),n=window.innerHeight,o=document.querySelector("[data-current-size]");switch(e.className=3==+t?"game-block__field game-block__field_small":4==+t||5==+t?"game-block__field":n-200>500?"game-block__field game-block__field_big":"game-block__field",+t){case 3:e.classList.add("tiles-3x3");break;case 5:e.classList.add("tiles-5x5");break;case 6:e.classList.add("tiles-6x6");break;case 7:e.classList.add("tiles-7x7");break;case 8:e.classList.add("tiles-8x8")}o.textContent="".concat(t,"x").concat(t),X.disable()}},P=F,R={started:!1,init:function(t){var e,n=y();C.stop(),t&&""===t.currentTarget.dataset.start&&(C.start(),R.started=!0),R.started&&h.delete(),h.get()?(e=h.get().moves,c||(c=document.querySelector("[data-moves]")),c.textContent=e,C.setValue(h.get().time),P.set(n),l(h.get().tilesNums,n),w(!0)):V(n,t),r.set(),M.setToDefault(),!X.enabled&&t&&""===t.currentTarget.dataset.start&&X.enable()},setStarted:function(t){R.started=t}},j=R;n(296);var G=a('<button class="volume-button" type="button"></button> ');G.addEventListener("click",(function(){p.togglePlaying(),this.classList.toggle("volume-button_muted")}));var K=G;function Q(t){var e=t.split(":");return 60*e[0]+ +e[1]}function U(t){this.value=t,this.left=null,this.right=null}var Z=function(t){if(!t.root)return null;for(var e=t.root;e.right;)e=e.right;return e},$=function(t){if(t.root)if(t.root.left||t.root.right||(t.root=null),!t.root.left||t.root.right){for(var e=null,n=t.root;n.right;)e=n,n=n.right;e.right=n.left,t.length--}else t.root=t.root.left},tt={save:function(){var t=tt.get()||{root:null,length:0},e=y(),n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),a={size:e,moves:n.textContent,time:o.textContent};if(Z(t)&&10===t.length){if(tt.has(t,a)||tt.moreThanBiggest(t,a))return;$(t)}!function(t,e){if(!t.root)return t.root=new U(e),void t.length++;for(var n=Q(e.time),o=+e.moves,a=t.root,i=a.value,l=Q(i.time),s=+i.moves;;){if(l=Q((i=a.value).time),s=+i.moves,n===l&&o===s){t.length--;break}if((n<l||n===l&&o<s)&&a.left)a=a.left;else{if((n<l||n===l&&o<s)&&!a.left){a.left=new U(e);break}if((n>l||n===l&&o>s)&&a.right)a=a.right;else if((n>l||n===l&&o>s)&&!a.right){a.right=new U(e);break}}}t.length<10&&t.length++}(t,a);var i=JSON.stringify(t);localStorage.setItem("leaderboard-".concat(e,"x").concat(e),i)},get:function(){var t=y(),e=localStorage.getItem("leaderboard-".concat(t,"x").concat(t));return e?JSON.parse(e):null},has:function(t,e){if(!t.root)return!1;for(var n=!1,o=t.root,a=Q(e.time),i=Q(o.value.time);;){if(a===(i=Q(o.value.time))&&e.moves===o.value.moves){n=!0;break}if((a<i||a===i&&e.moves<o.value.moves)&&o.left)o=o.left;else{if(!(a>i||a===i&&e.moves>o.value.moves)||!o.right)break;o=o.right}}return n},moreThanBiggest:function(t,e){if(!t.root)return!1;var n=Z(t),o=Q(n.value.time),a=Q(e.time);return o<a||o===a&&n.value.moves<e.moves}},et=tt;function nt(t,e){t.left&&nt(t.left,e),e(t),t.right&&nt(t.right,e)}function ot(t,e){if(!t.root)return null;nt(t.root,e)}var at=document.querySelector(".leaderboard"),it=1,lt={show:function(){at||(at=document.querySelector(".leaderboard"));var t=et.get();t?lt.fill(t):lt.fill(),E.show(".leaderboard")},fill:function(t){if(at||(at=document.querySelector(".leaderboard")),at.innerHTML="",t){var e=B("h2","Results");at.append(e),ot(t,lt.createAndAppendItem),it=1}else{var n=B("h2","No results for this frame size yet");at.append(n)}},createAndAppendItem:function(t){var e=document.createElement("div");e.className="leaderboard__item",e.textContent=it+".";var n=document.createElement("div");n.className="leaderboard__item leaderboard__item_big",n.textContent="".concat(t.value.moves," / ").concat(t.value.time);var o=document.createElement("div");o.className="leaderboard__item",o.textContent="Frame size: ".concat(t.value.size,"x").concat(t.value.size);var i,l,s,r,c=(i=e,l=n,s=o,(r=a('<div class="column-3-center-big"></div> ')).append(i,l,s),r);at.append(c),it++}},st=lt;function rt(t,e,n){var o=a('<button class="small-button" type="button"></button> ');return o.textContent=t,o.addEventListener("click",e),n&&o.setAttribute(n,""),o}function ct(t,e,n){var o=a('<button class="underlined-button" type="button"></button> ');if(o.addEventListener("click",e),o.textContent=t,n&&n.includes("=")){var i=n.split("=");o.setAttribute(i[0],i[1])}else n&&o.setAttribute(n,"");return o}var ut=a('<div class="game-block"> <div class="game-block__heading"> <div class="game-block__controls"></div> <div class="game-block__info"> <div class="game-block__data">Moves: <span data-moves>0</span></div> <div class="game-block__data">Time: <span data-time>00:00</span></div> </div> </div> <div class="game-block__field"></div> <div class="game-block__footer"> <div class="game-block__info"> <div class="game-block__data game-block__data_small">Frame size: <span data-current-size>4x4</span></div> </div> <div class="game-block__controls game-block__controls_small"> <span>Other sizes:</span> </div> </div> </div> '),dt=ut.querySelector(".game-block__heading .game-block__controls"),mt=rt("Shuffle and start",j.init,"data-start"),vt=rt("Stop",(function(){if(q||(q=document.querySelector("[data-time-button]")),h.get()&&!j.started)return j.setStarted(!0),q.textContent="Stop",C.continue(),X.enabled||X.enable(),void h.delete();C.paused&&j.started?(q.textContent="Stop",C.continue(),X.enabled||X.enable()):j.started&&(q.textContent="Continue",C.stop(),X.enabled&&X.disable())}),"data-time-button"),pt=rt("Save",(function(){if(M.completed&&et.save(),j.started){var t=document.querySelectorAll(".tile"),e=[];t.forEach((function(t){t.classList.contains("tile_empty")?e.push(0):e.push(+t.textContent)}));var n=document.querySelector("[data-moves]"),o=document.querySelector("[data-time]"),a=Math.sqrt(t.length),i={tilesNums:e,size:a,moves:n.textContent,time:o.textContent},l=JSON.stringify(i);localStorage.setItem("progress",l)}})),ft=rt("Results",st.show);dt.append(mt,vt,pt,ft);for(var gt=ut.querySelector(".game-block__footer .game-block__controls"),ht=3;ht<9;ht++){var yt=ct("".concat(ht,"x").concat(ht),P.handler,"data-size=".concat(ht));gt.append(yt)}var bt=ut;function _t(t){var e=a('<div class="popup"> <div class="popup__body"> <button class="popup__button" type="button"></button> </div> <div class="popup__background"></div> </div> ');return e.querySelector(".popup__body").prepend(t),e}var xt=a('<div class="leaderboard"></div> '),St=a('<div class="congratulations"></div> '),kt=_t(xt),Lt=_t(St),Tt=a('<div class="wrapper"></div> ');Tt.append(bt,K,kt,Lt);var Ct=Tt;document.body.append(Ct),j.init()},296:function(){var t=0;document.addEventListener("touchend",(function(e){var n=(new Date).getTime();n-t<=300&&e.preventDefault(),t=n}),!1)}},function(t){t(t.s=394)}]);